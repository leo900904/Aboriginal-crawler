# æ–°é é¢çˆ¬èŸ²é–‹ç™¼æŒ‡å—

ç’°å¢ƒï¼šç›´æ¥ä½¿ç”¨
conda env create -f environment.yml
å’Œ 
conda activate aborigin-beautifulsoup

## æ¦‚è¿°

æœ¬æŒ‡å—è©³ç´°èªªæ˜å¦‚ä½•ç‚º klokah.tw åŸä½æ°‘èªå­¸ç¿’ç¶²ç«™é–‹ç™¼æ–°é é¢çš„çˆ¬èŸ²ç¨‹å¼ã€‚æ‰€æœ‰çˆ¬èŸ²éƒ½éµå¾ªçµ±ä¸€çš„æ¶æ§‹æ¨¡å¼ï¼Œç¢ºä¿éŸ³æª”å’Œæ–‡å­—çš„æ­£ç¢ºå°æ‡‰ã€‚

## å°ˆæ¡ˆçµæ§‹

```
Aboriginçˆ¬èŸ²/
â”œâ”€â”€ main.py                    # ä¸»ç¨‹å¼ï¼ŒåŒ…å«æ‰€æœ‰çˆ¬èŸ²çš„çµ±ä¸€å…¥å£
â”œâ”€â”€ crawlers/                  # çˆ¬èŸ²æ¨¡çµ„ç›®éŒ„
â”‚   â”œâ”€â”€ __init__.py           # æ¨¡çµ„åˆå§‹åŒ–æ–‡ä»¶
â”‚   â”œâ”€â”€ utils.py              # å…±ç”¨å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ state.py              # å…¨åŸŸç‹€æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ alphabet_crawler.py   # å­—æ¯ç¯‡çˆ¬èŸ²ï¼ˆéœæ…‹éŸ³æª”ç¯„ä¾‹ï¼‰
â”‚   â”œâ”€â”€ dialogue_crawler.py   # æƒ…å¢ƒæ—èªçˆ¬èŸ²ï¼ˆå‹•æ…‹éŸ³æª”ç¯„ä¾‹ï¼‰
â”‚   â”œâ”€â”€ essay_crawler.py      # æ—èªçŸ­æ–‡çˆ¬èŸ²
â”‚   â”œâ”€â”€ sentence_crawler.py   # å¥å‹ç¯‡çˆ¬èŸ²
â”‚   â”œâ”€â”€ vocabulary_crawler.py # å­¸ç¿’è©è¡¨çˆ¬èŸ²
â”‚   â””â”€â”€ ...                   # å…¶ä»–å°ˆæ¥­çˆ¬èŸ²
â””â”€â”€ collect_env_info.py       # ç’°å¢ƒè³‡è¨Šæ”¶é›†å·¥å…·
```

## ç›®å‰ç¼ºå°‘çš„é é¢çˆ¬èŸ²

æ ¹æ“š main.py ä¸­çš„è¨»é‡‹ï¼Œé‚„éœ€è¦é–‹ç™¼ä»¥ä¸‹é é¢çš„çˆ¬èŸ²ï¼š

### è£œå……æ•™æ
- **é–±è®€æ–‡æœ¬** - éœ€è¦é–‹ç™¼ `reading_text_crawler.py`

### æ•™ææ•™å…·å­¸ç¿’
- **WAWAé»é»æ¨‚** - éœ€è¦é–‹ç™¼ `wawa_game_crawler.py`
- **ä¸»é¡Œå¼æ›åœ–** (èº«é«”ã€è¦ªå±¬ã€å±±å·è‡ªç„¶ã€å‹•ç‰©) - éœ€è¦é–‹ç™¼ `thematic_chart_crawler.py`
- **LIMAæœ‰è²æ›¸** - éœ€è¦é–‹ç™¼ `lima_audiobook_crawler.py`

### é–‹æ”¾å¹³å°
- **ç¹ªæœ¬å¹³å°** - éœ€è¦é–‹ç™¼ `picture_book_crawler.py`
- **å‹•ç•«å¹³å°** - éœ€è¦é–‹ç™¼ `animation_crawler.py`
- **å½±éŸ³ä¸­å¿ƒ** - éœ€è¦é–‹ç™¼ `media_center_crawler.py`
- **è‡ªç·¨æ•™æ** - éœ€è¦é–‹ç™¼ `self_compiled_materials_crawler.py`
- **æ•™æ¡ˆå¹³å°** - éœ€è¦é–‹ç™¼ `lesson_plan_crawler.py`
- **å¥æ³•æ¼”ç·´å¹³å°** - éœ€è¦é–‹ç™¼ `syntax_practice_crawler.py`

## æ–°çˆ¬èŸ²é–‹ç™¼æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šåˆ†æç›®æ¨™é é¢

1. **è¨ªå•ç›®æ¨™ç¶²å€**ï¼šä½¿ç”¨ç€è¦½å™¨è¨ªå•è¦çˆ¬å–çš„é é¢
2. **F12 é–‹ç™¼è€…å·¥å…·åˆ†æ**ï¼š
   - **Network é¢æ¿**ï¼šè§€å¯ŸéŸ³æª”è¼‰å…¥æ–¹å¼
     - éœæ…‹éŸ³æª”ï¼šç›´æ¥åœ¨ HTML ä¸­æœ‰ `<audio>` æˆ– `<a href="*.mp3">` æ¨™ç±¤
     - å‹•æ…‹éŸ³æª”ï¼šé€é JavaScript è«‹æ±‚ï¼Œåœ¨ Network ä¸­è§€å¯Ÿ XHR/Fetch è«‹æ±‚
   - **Elements é¢æ¿**ï¼šåˆ†æé é¢çµæ§‹å’Œæ–‡å­—å…ƒç´ ä½ç½®
   - **Console é¢æ¿**ï¼šæ¸¬è©¦ JavaScript é¸æ“‡å™¨

### ç¬¬äºŒæ­¥ï¼šå»ºç«‹çˆ¬èŸ²æ–‡ä»¶

åœ¨ `crawlers/` ç›®éŒ„ä¸‹å»ºç«‹æ–°çš„çˆ¬èŸ²æ–‡ä»¶ï¼Œå‘½åæ ¼å¼ç‚º `{åŠŸèƒ½åç¨±}_crawler.py`

#### åŸºæœ¬æ¨¡æ¿çµæ§‹ï¼š

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os
import time
import logging
import re
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import NoSuchElementException, TimeoutException
from crawlers.utils import download_audio, save_label, clean_romaji
from crawlers.state import CREATED_FOLDERS

def crawl_your_function_name(driver, main_lang, dialect, folder_name):
    """
    çˆ¬å–åŠŸèƒ½çš„ä¸»å‡½æ•¸
    
    Args:
        driver: Selenium WebDriver å¯¦ä¾‹
        main_lang: ä¸»èªè¨€åç¨± (ä¾‹å¦‚: "æ³°é›…èª")
        dialect: æ–¹è¨€åç¨± (ä¾‹å¦‚: "è³½è€ƒåˆ©å…‹æ³°é›…èª") 
        folder_name: è³‡æ–™å¤¾åç¨± (ä¾‹å¦‚: "æ–°åŠŸèƒ½")
    """
    
    # 1. å»ºç«‹è³‡æ–™å¤¾çµæ§‹
    topic_folder = os.path.join(main_lang, dialect, folder_name)
    os.makedirs(topic_folder, exist_ok=True)
    
    record_folder = os.path.join(topic_folder, f"{folder_name}-10")
    os.makedirs(record_folder, exist_ok=True)
    
    audio_folder = os.path.join(record_folder, "audio")
    os.makedirs(audio_folder, exist_ok=True)
    
    label_file = os.path.join(record_folder, "label.txt")
    CREATED_FOLDERS.add(record_folder)
    
    # åˆå§‹åŒ– label.txt
    with open(label_file, "w", encoding="utf-8") as f:
        f.write("")
    
    # 2. è¨ˆç®—éŸ³æª”ç·¨è™Ÿèµ·å§‹å€¼
    counter = len([f for f in os.listdir(audio_folder) if f.lower().endswith('.mp3')]) + 1
    
    try:
        # 3. çˆ¬å–é‚è¼¯å¯¦ä½œ
        # ... åœ¨é€™è£¡å¯¦ä½œä½ çš„çˆ¬å–é‚è¼¯
        pass
        
    except Exception as e:
        logging.error(f"çˆ¬å– {folder_name} æ™‚å‡ºéŒ¯: {e}")
```

### ç¬¬ä¸‰æ­¥ï¼šéŸ³æª”è™•ç†ç­–ç•¥

#### éœæ…‹éŸ³æª”è™•ç†ï¼ˆåƒè€ƒ alphabet_crawler.pyï¼‰

```python
# ç›´æ¥å¾ HTML å…ƒç´ ç²å–éŸ³æª” URL
try:
    audio_tag = driver.find_element(By.CSS_SELECTOR, "a.audio-link")
    audio_url = audio_tag.get_attribute("href")
    
    mp3_name = f"{counter:04d}.mp3"
    download_audio(audio_url, mp3_name, audio_folder)
    
    # å„²å­˜æ–‡å­—æ¨™ç±¤
    save_label(text_content, mp3_name, label_file)
    counter += 1
    
except Exception as e:
    logging.warning(f"éœæ…‹éŸ³æª”ä¸‹è¼‰å¤±æ•—: {e}")
```

#### å‹•æ…‹éŸ³æª”è™•ç†ï¼ˆåƒè€ƒ dialogue_crawler.pyï¼‰

```python
# æ–¹æ³•1ï¼šå¾é è¼‰çš„ audioSet ç²å–éŸ³æª”
def get_audio_mapping(driver):
    """ç²å–é é¢é è¼‰çš„éŸ³æª”æ˜ å°„"""
    audio_map = {}
    try:
        audio_set = driver.find_element(By.ID, "audioSet")
        audio_tags = audio_set.find_elements(By.CSS_SELECTOR, "audio.player-ab")
        for audio in audio_tags:
            data_value = audio.get_attribute("data-value")
            try:
                source = audio.find_element(By.TAG_NAME, "source")
                src = source.get_attribute("src")
                audio_map[data_value] = src
                logging.info(f"éŸ³æª”æ˜ å°„: {data_value} -> {src}")
            except Exception:
                continue
    except Exception as e:
        logging.warning(f"æ‰¾ä¸åˆ° audioSet: {e}")
    return audio_map

# ä½¿ç”¨éŸ³æª”æ˜ å°„
audio_map = get_audio_mapping(driver)
play_btn = element.find_element(By.CSS_SELECTOR, "button.sound-btn")
data_value = play_btn.get_attribute("data-value")

if data_value and data_value in audio_map:
    audio_src = audio_map[data_value]
    download_audio(audio_src, mp3_name, audio_folder)
```

```python
# æ–¹æ³•2ï¼šä½¿ç”¨ Selenium Wire ç›£è½ç¶²è·¯è«‹æ±‚
# åœ¨ main.py ä¸­å·²ç¶“ä½¿ç”¨ seleniumwire.webdriver

# é»æ“Šæ’­æ”¾æŒ‰éˆ•è§¸ç™¼éŸ³æª”è«‹æ±‚
play_button.click()
time.sleep(1)

# å¾ç¶²è·¯è«‹æ±‚ä¸­æ‰¾åˆ°éŸ³æª”
for request in driver.requests:
    if request.response and 'audio' in request.response.headers.get('content-type', ''):
        audio_content = request.response.body
        with open(os.path.join(audio_folder, mp3_name), 'wb') as f:
            f.write(audio_content)
        break
```

### ç¬¬å››æ­¥ï¼šæ–‡å­—èˆ‡éŸ³æª”å°æ‡‰

ç¢ºä¿æ–‡å­—å’ŒéŸ³æª”çš„æ­£ç¢ºå°æ‡‰æ˜¯é—œéµï¼š

```python
# ç¯„ä¾‹ï¼šè™•ç†åŸä½æ°‘èªå’Œä¸­æ–‡å°æ‡‰
try:
    # æå–åŸä½æ°‘èªæ–‡å­—
    aboriginal_text = driver.find_element(By.CSS_SELECTOR, ".aboriginal-text").text.strip()
    
    # æå–ä¸­æ–‡ç¿»è­¯
    chinese_text = driver.find_element(By.CSS_SELECTOR, ".chinese-text").text.strip()
    
    # æ¸…ç†æ–‡å­—ï¼ˆç§»é™¤ä¸å¿…è¦çš„ç¬¦è™Ÿï¼‰
    aboriginal_clean = re.sub(r'\([^)]*\)', '', aboriginal_text).strip()
    chinese_clean = re.sub(r'\([^)]*\)', '', chinese_text).strip()
    
    # çµ„åˆæ ¼å¼ï¼šä¸­æ–‡(åŸä½æ°‘èª)
    combined_text = f"{chinese_clean}({aboriginal_clean})"
    
    # å„²å­˜åˆ° label.txt
    mp3_name = f"{counter:04d}.mp3"
    with open(label_file, "a", encoding="utf-8") as f:
        f.write(f"{mp3_name}\n")
        f.write(f"{combined_text}\n")
        f.write("male\n")
        f.write("one\n")
        f.write("\n")
        
except Exception as e:
    logging.error(f"æ–‡å­—æå–å¤±æ•—: {e}")
```

### ç¬¬äº”æ­¥ï¼šåœ¨ main.py ä¸­è¨»å†Šçˆ¬èŸ²

1. **æ·»åŠ å°å…¥èªå¥**ï¼ˆåœ¨æª”æ¡ˆé–‹é ­ï¼‰ï¼š
```python
from crawlers.your_new_crawler import crawl_your_function_name
```

2. **åœ¨ crawlers å­—å…¸ä¸­æ·»åŠ é…ç½®**ï¼š
```python
crawlers = {
    # ... ç¾æœ‰çš„çˆ¬èŸ²é…ç½® ...
    
    'ä½ çš„æ–°åŠŸèƒ½åç¨±': {
        'url': 'https://web.klokah.tw/your-new-page/',
        'func': crawl_your_function_name,
        'folder': 'ä½ çš„æ–°åŠŸèƒ½åç¨±'
    },
}
```

3. **æ¸¬è©¦å–®ä¸€çˆ¬èŸ²æ™‚ï¼Œè¨»è§£å…¶ä»–çˆ¬èŸ²**ï¼š
```python
# åœ¨ main() å‡½æ•¸ä¸­ï¼Œæš«æ™‚è¨»è§£æ‰å…¶ä»–çˆ¬èŸ²é…ç½®
for name, config in crawlers.items():
    if name != 'ä½ çš„æ–°åŠŸèƒ½åç¨±':  # åªåŸ·è¡Œä½ è¦æ¸¬è©¦çš„çˆ¬èŸ²
        continue
    # ... çˆ¬å–é‚è¼¯
```

### ç¬¬å…­æ­¥ï¼šéŒ¯èª¤è™•ç†å’Œæ—¥èªŒ

```python
import logging

# åœ¨å‡½æ•¸é–‹å§‹æ™‚è¨˜éŒ„
logging.info(f"é–‹å§‹çˆ¬å– {folder_name}")

# åœ¨é—œéµæ­¥é©Ÿæ·»åŠ æ—¥èªŒ
logging.info(f"æ‰¾åˆ° {len(elements)} å€‹å…ƒç´ ")

# éŒ¯èª¤è™•ç†
try:
    # çˆ¬å–é‚è¼¯
    pass
except TimeoutException:
    logging.warning("ç­‰å¾…å…ƒç´ è¶…æ™‚")
except NoSuchElementException:
    logging.warning("æ‰¾ä¸åˆ°æŒ‡å®šå…ƒç´ ")
except Exception as e:
    logging.error(f"æœªé æœŸçš„éŒ¯èª¤: {e}")
```

## å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

### 1. é é¢è¼‰å…¥ç·©æ…¢
```python
# å¢åŠ ç­‰å¾…æ™‚é–“
WebDriverWait(driver, 30).until(
    EC.presence_of_element_located((By.CSS_SELECTOR, "your-selector"))
)
```

### 2. å‹•æ…‹å…§å®¹è¼‰å…¥
```python
# ç­‰å¾…ç‰¹å®šå…§å®¹è®ŠåŒ–
WebDriverWait(driver, 10).until(
    lambda d: d.find_element(By.CSS_SELECTOR, ".content").text != old_content
)
```

### 3. éŸ³æª”æ ¼å¼è½‰æ›
```python
# å¦‚æœé‡åˆ° WAV æ ¼å¼ï¼Œéœ€è¦è½‰æ›ç‚º MP3
def convert_wav_to_mp3(wav_data, output_mp3_path):
    import subprocess
    import tempfile
    
    with tempfile.NamedTemporaryFile(suffix='.wav', delete=False) as temp_wav:
        temp_wav.write(wav_data)
        temp_wav_path = temp_wav.name

    subprocess.run([
        'ffmpeg', '-i', temp_wav_path,
        '-acodec', 'libmp3lame', '-y',
        output_mp3_path
    ], check=True, capture_output=True)
    
    os.unlink(temp_wav_path)
```

### 4. iframe è™•ç†
```python
# å¦‚æœå…§å®¹åœ¨ iframe ä¸­
iframe = driver.find_element(By.CSS_SELECTOR, "iframe")
driver.switch_to.frame(iframe)

# çˆ¬å– iframe å…§å®¹
# ...

# åˆ‡å›ä¸»é é¢
driver.switch_to.default_content()
```

## æ¸¬è©¦å’Œé™¤éŒ¯

1. **ä½¿ç”¨ driver.save_screenshot('debug.png')** åœ¨é—œéµæ­¥é©Ÿæˆªåœ–
2. **æ·»åŠ  time.sleep() è§€å¯Ÿé é¢è®ŠåŒ–**
3. **ä½¿ç”¨ print() æˆ– logging.info() è¼¸å‡ºä¸­é–“çµæœ**
4. **åœ¨ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·ä¸­å…ˆæ¸¬è©¦é¸æ“‡å™¨**

## éŸ³æª”é¡å‹è­˜åˆ¥èˆ‡è™•ç†ç­–ç•¥ ğŸµ

### éŸ³æª”çš„å…©ç¨®é¡å‹

#### ğŸ”— éœæ…‹éŸ³æª”ï¼ˆStatic Audio Filesï¼‰
**ç‰¹å¾µ**ï¼š
- HTML ä¸­ç›´æ¥åŒ…å«éŸ³æª”çš„å®Œæ•´ URL
- é€šå¸¸ä»¥ `<audio>` æ¨™ç±¤æˆ– `<a href="*.mp3">` å½¢å¼å‡ºç¾  
- éŸ³æª” URL åœ¨é é¢è¼‰å…¥æ™‚å°±å·²ç¢ºå®š
- å¯ä»¥ç›´æ¥å³éµè¤‡è£½éŸ³æª”é€£çµ

**è­˜åˆ¥æ–¹æ³•**ï¼š
```html
<!-- ç¯„ä¾‹1ï¼šaudio æ¨™ç±¤ -->
<audio controls>
    <source src="audio/word001.mp3" type="audio/mpeg">
</audio>

<!-- ç¯„ä¾‹2ï¼šé€£çµæ¨™ç±¤ -->
<a href="sounds/pronunciation.mp3" class="audio-link">æ’­æ”¾</a>

<!-- ç¯„ä¾‹3ï¼šæŒ‰éˆ•å¸¶æœ‰éŸ³æª”å±¬æ€§ -->
<button data-audio="media/sample.mp3" class="play-btn">â–¶ï¸</button>
```

**è™•ç†æ–¹å¼**ï¼š
```python
# ç›´æ¥ç²å–éŸ³æª” URL ä¸¦ä¸‹è¼‰
try:
    # æ–¹æ³•1ï¼šå¾ audio æ¨™ç±¤ç²å–
    audio_element = driver.find_element(By.CSS_SELECTOR, "audio source")
    audio_url = audio_element.get_attribute("src")
    
    # æ–¹æ³•2ï¼šå¾é€£çµç²å–
    link_element = driver.find_element(By.CSS_SELECTOR, "a.audio-link")
    audio_url = link_element.get_attribute("href")
    
    # ç›´æ¥ä¸‹è¼‰
    download_audio(audio_url, mp3_name, audio_folder)
    
except Exception as e:
    logging.warning(f"éœæ…‹éŸ³æª”è™•ç†å¤±æ•—: {e}")
```

#### âš¡ å‹•æ…‹éŸ³æª”ï¼ˆDynamic Audio Filesï¼‰
**ç‰¹å¾µ**ï¼š
- éŸ³æª” URL ä¸åœ¨ HTML ä¸­ç›´æ¥é¡¯ç¤º
- é€é JavaScript/AJAX å‹•æ…‹è¼‰å…¥
- éœ€è¦é»æ“Šæ’­æ”¾æŒ‰éˆ•æˆ–è§¸ç™¼ç‰¹å®šäº‹ä»¶æ‰æœƒç”¢ç”Ÿè«‹æ±‚
- éŸ³æª”å¯èƒ½é€é API å‘¼å«æˆ–å³æ™‚ç”Ÿæˆ

**ğŸ” F12 é–‹ç™¼è€…å·¥å…·åˆ†ææ­¥é©Ÿ**ï¼š
1. **æ‰“é–‹ F12 â†’ Network é¢æ¿**
2. **æ¸…ç©º Network ç´€éŒ„**ï¼ˆé»æ“Šåƒåœ¾æ¡¶åœ–ç¤ºï¼‰
3. **é»æ“Šæ’­æ”¾æŒ‰éˆ•**
4. **è§€å¯Ÿæ–°å¢çš„ç¶²è·¯è«‹æ±‚**

```
ğŸ” åœ¨ Network é¢æ¿ä¸­å°‹æ‰¾ï¼š
- Type: Media æˆ– XHR/Fetch
- æª”æ¡ˆé¡å‹ï¼š.mp3, .wav, .ogg ç­‰
- Content-Type: audio/*
- å›æ‡‰å…§å®¹ç‚ºéŸ³æª”è³‡æ–™
```

**è™•ç†æ–¹æ³•**ï¼š

**æ–¹æ³•Aï¼šé è¼‰éŸ³æª”æ˜ å°„ï¼ˆæ¨è–¦ï¼‰**
```python
def get_audio_mapping(driver):
    """ç²å–é é¢é è¼‰çš„éŸ³æª”æ˜ å°„"""
    audio_map = {}
    try:
        # å°‹æ‰¾éš±è—çš„éŸ³æª”å®¹å™¨ï¼ˆé€šå¸¸æ˜¯ audioSetï¼‰
        audio_set = driver.find_element(By.ID, "audioSet") 
        audio_tags = audio_set.find_elements(By.CSS_SELECTOR, "audio.player-ab")
        
        for audio in audio_tags:
            data_value = audio.get_attribute("data-value")
            try:
                source = audio.find_element(By.TAG_NAME, "source")
                src = source.get_attribute("src")
                audio_map[data_value] = src
                logging.info(f"ğŸµ éŸ³æª”æ˜ å°„: {data_value} -> {src}")
            except Exception:
                continue
                
    except Exception as e:
        logging.warning(f"æ‰¾ä¸åˆ° audioSet: {e}")
    return audio_map

# ä½¿ç”¨æ˜ å°„ä¸‹è¼‰éŸ³æª”
audio_map = get_audio_mapping(driver)
play_btn = driver.find_element(By.CSS_SELECTOR, "button.sound-btn")
data_value = play_btn.get_attribute("data-value")

if data_value and data_value in audio_map:
    audio_src = audio_map[data_value]
    download_audio(audio_src, mp3_name, audio_folder)
```

**æ–¹æ³•Bï¼šSelenium Wire ç¶²è·¯ç›£è½**
```python
# æ¸…ç©ºä¹‹å‰çš„è«‹æ±‚ç´€éŒ„
driver.requests.clear()

# é»æ“Šæ’­æ”¾æŒ‰éˆ•è§¸ç™¼éŸ³æª”è«‹æ±‚
play_button.click()
time.sleep(2)  # ç­‰å¾…è«‹æ±‚å®Œæˆ

# å¾ç¶²è·¯è«‹æ±‚ä¸­å°‹æ‰¾éŸ³æª”
for request in driver.requests:
    if request.response:
        content_type = request.response.headers.get('content-type', '')
        
        # æª¢æŸ¥æ˜¯å¦ç‚ºéŸ³æª”
        if 'audio' in content_type or request.url.endswith(('.mp3', '.wav', '.ogg')):
            audio_content = request.response.body
            
            # å„²å­˜éŸ³æª”
            audio_path = os.path.join(audio_folder, mp3_name)
            with open(audio_path, 'wb') as f:
                f.write(audio_content)
            
            logging.info(f"ğŸ“¡ é€éç¶²è·¯ç›£è½ä¸‹è¼‰: {mp3_name}")
            break
```

### ğŸ“‹ å¯¦éš›å°ˆæ¡ˆç¯„ä¾‹

**alphabet_crawler.pyï¼ˆéœæ…‹éŸ³æª”ï¼‰**ï¼š
```python
# å­—æ¯ç¯‡ - ç›´æ¥å¾ HTML é€£çµç²å–éŸ³æª”
audio_tag = driver.find_element(By.CSS_SELECTOR, "a.sm2_button.audio")
audio_url = audio_tag.get_attribute("href")  # ğŸ”— éœæ…‹é€£çµ
download_audio(audio_url, mp3_name, audio_folder)
```

**dialogue_crawler.pyï¼ˆå‹•æ…‹éŸ³æª”ï¼‰**ï¼š
```python
# æƒ…å¢ƒæ—èª - ä½¿ç”¨é è¼‰éŸ³æª”æ˜ å°„
audio_map = get_audio_mapping(driver)  # âš¡ å‹•æ…‹æ˜ å°„
data_value = play_btn.get_attribute("data-value")
if data_value in audio_map:
    download_audio(audio_map[data_value], mp3_name, audio_folder)
```

### ğŸ” åˆ¤æ–·éŸ³æª”é¡å‹çš„æ–¹æ³•

**é–‹ç™¼å‰çš„åˆ†ææµç¨‹**ï¼š
1. **æ‰“é–‹ç›®æ¨™ç¶²é **
2. **F12 â†’ Elements**ï¼šæœå°‹ `audio`ã€`mp3`ã€`sound` ç­‰é—œéµå­—
3. **F12 â†’ Network**ï¼šæ¸…ç©ºç´€éŒ„ â†’ é»æ“Šæ’­æ”¾ â†’ è§€å¯Ÿè«‹æ±‚
4. **åˆ¤æ–·**ï¼š
   - HTML ä¸­æœ‰éŸ³æª” URL â†’ **ğŸ”— éœæ…‹éŸ³æª”**
   - é»æ“Šå¾Œæ‰å‡ºç¾éŸ³æª”è«‹æ±‚ â†’ **âš¡ å‹•æ…‹éŸ³æª”**

---

**æ³¨æ„äº‹é …**ï¼š
- ç¢ºä¿éŸ³æª”å’Œæ–‡å­—çš„å°æ‡‰é—œä¿‚æ­£ç¢º 